{% extends 'pqrs/template.html' %} {% block content %} {% load crispy_forms_tags %}

<div class="card mb-4">
  <div class="card-header">Búsqueda de remitentes</div>
  <div class="card-body">
    <form action="{% url 'pqrs:search_person'%}" method="post">
      {{ form | crispy }} {% csrf_token %}
      <input type="submit" name="search" value="Buscar" class="btn btn-success lift" />
      <!--<a title="Radicar" data-toggle="tooltip"  href="{% url 'pqrs:create_person' %}" class="btn btn-success lift">Radicar</a>-->
    </form>
    <div class="alert alert-success mt-4" role="alert">
      <h4 class="alert-heading">Remitentes</h4>
      <p>
        Debes realizar una búsqueda de remitentes antes de la entrada de documentos, puedes realizarla con nombres
        personales, direcciones, correo electrónico o nombre de la organización
      </p>
      <hr />
      <p class="mb-0">Una vez encontrado el remitente puedes seguir con los pasos</p>
    </div>
  </div>
</div>
{% if list %}
<div class="card mb-4">
  <div class="card-header">Resultado</div>
  <div class="card-body">
    <div class="row">
      {% for person in list%}
      <div class="col-md-4">
        <div class="card border-primary mb-3">
          <h5 class="card-header text-primary">
            Resultado {{forloop.counter}}
            <a
              title="Enviar correo"
              data-toggle="tooltip"
              href="{% url 'pqrs:send_email_person' pk=person.pk %}"
              class="btn btn-datatable btn-icon btn-transparent-dark"
            >
              <i style="height: 1.5rem; width: 1.5rem" data-feather="mail"></i>
            </a>
          </h5>
          <div class="card-body border-primary">
            <p class="card-text">Nombre: {{ person.get_anonymized_name }}</p>
            <p class="card-text">Email: {{ person.get_anonymized_email }}</p>
            <p class="card-text">Address: {{person.get_anonymized_address }}</p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
{% else %} {% if person_form %}
<div class="card mb-4">
  <div class="card-header">Persona</div>
  <div class="card-body">
    <form method="post" id="sender_create_form">{% crispy person_form %} {% csrf_token %}</form>
  </div>
</div>
<div class="card mb-4" id="form_container" hidden>
  <div class="card-header">Persona</div>
  <div class="card-body">
    <table class="table table-hover">
      <thead>
        <tr>
          <th scope="col">Nombre y apellido</th>
          <th scope="col">Tipo y Numero de Documento</th>
          <th scope="col">Acci&oacute;n</th>
        </tr>
      </thead>
      <tbody id="tb_request_sender"></tbody>
    </table>
  </div>
</div>

<div class="alert alert-danger fade show" style="display: none" role="alert" id="alertMessageContainer">
  <h4 class="alert-heading">
    Ups algo salio mal!
    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
  </h4>
  <p id="alertMessageContent"></p>
</div>
{% endif %} {% endif %} {% endblock %}
